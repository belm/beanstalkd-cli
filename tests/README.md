# Beanstalkd CLI æµ‹è¯•å¥—ä»¶

[ğŸ‡¨ğŸ‡³ ä¸­æ–‡ç‰ˆ](README.md) | [ğŸ‡ºğŸ‡¸ English](README-EN.md)

å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹é›†åˆï¼Œç”¨äºéªŒè¯ beanstalkd-cli çš„æ‰€æœ‰åŠŸèƒ½ã€‚

## æµ‹è¯•æ–‡ä»¶è¯´æ˜

### 1. `connection_test.go` - è¿æ¥æµ‹è¯•
- åŸºæœ¬è¿æ¥åŠŸèƒ½
- è¿æ¥è¶…æ—¶
- è¿æ¥å¤±è´¥å¤„ç†
- å¤šä¸ªå¹¶å‘è¿æ¥
- è¿æ¥æ€§èƒ½åŸºå‡†æµ‹è¯•

### 2. `job_operations_test.go` - ä»»åŠ¡æ“ä½œæµ‹è¯•
- Putï¼šæ’å…¥ä»»åŠ¡ï¼ˆæ™®é€šã€é«˜ä¼˜å…ˆçº§ã€å»¶è¿Ÿã€ä¸­æ–‡ã€JSONï¼‰
- Reserveï¼šé¢„ç•™ä»»åŠ¡
- Deleteï¼šåˆ é™¤ä»»åŠ¡
- Releaseï¼šé‡Šæ”¾ä»»åŠ¡
- Buryï¼šåŸ‹è‘¬ä»»åŠ¡
- Touchï¼šè§¦æ‘¸ä»»åŠ¡
- Kickï¼šè¸¢å‡ºä»»åŠ¡
- æ€§èƒ½åŸºå‡†æµ‹è¯•

### 3. `peek_operations_test.go` - æŸ¥çœ‹æ“ä½œæµ‹è¯•
- Peekï¼šæŸ¥çœ‹æŒ‡å®šä»»åŠ¡
- PeekReadyï¼šæŸ¥çœ‹å°±ç»ªä»»åŠ¡
- PeekDelayedï¼šæŸ¥çœ‹å»¶è¿Ÿä»»åŠ¡
- PeekBuriedï¼šæŸ¥çœ‹è¢«åŸ‹è‘¬ä»»åŠ¡
- é”™è¯¯å¤„ç†æµ‹è¯•

### 4. `tube_operations_test.go` - Tube æ“ä½œæµ‹è¯•
- åˆ—å‡ºæ‰€æœ‰ tubes
- å¤š tube æ“ä½œ
- Tube ç»Ÿè®¡ä¿¡æ¯
- Tube éš”ç¦»æ€§
- å¹¶å‘ tube è®¿é—®

### 5. `stats_test.go` - ç»Ÿè®¡ä¿¡æ¯æµ‹è¯•
- æœåŠ¡å™¨ç»Ÿè®¡
- ä»»åŠ¡ç»Ÿè®¡
- Tube ç»Ÿè®¡

### 6. `integration_test.go` - é›†æˆæµ‹è¯•
- å®Œæ•´çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æµç¨‹
- ä»»åŠ¡é‡è¯•æœºåˆ¶
- ä¼˜å…ˆçº§é˜Ÿåˆ—

## è¿è¡Œæµ‹è¯•

### å‰ææ¡ä»¶
ç¡®ä¿ beanstalkd æœåŠ¡è¿è¡Œåœ¨ `127.0.0.1:11300`

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
cd tests
go test -v
```

### è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
```bash
go test -v -run TestConnection
go test -v -run TestPutJob
go test -v -run TestProducerConsumerFlow
```

### è¿è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
```bash
go test -bench=. -benchmem
```

### æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
```bash
go test -cover
go test -coverprofile=coverage.out
go tool cover -html=coverage.out
```

## æµ‹è¯•è¦†ç›–èŒƒå›´

âœ… è¿æ¥ç®¡ç†
âœ… ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸï¼ˆput, reserve, delete, release, bury, touch, kickï¼‰
âœ… æŸ¥çœ‹æ“ä½œï¼ˆpeek ç³»åˆ—ï¼‰
âœ… Tube ç®¡ç†
âœ… ç»Ÿè®¡ä¿¡æ¯
âœ… ä¼˜å…ˆçº§å¤„ç†
âœ… å»¶è¿Ÿé˜Ÿåˆ—
âœ… é”™è¯¯å¤„ç†
âœ… å¹¶å‘æ“ä½œ
âœ… é›†æˆæµç¨‹

## æµ‹è¯•æœ€ä½³å®è·µ

1. **éš”ç¦»æ€§**: æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„ tube åç§°
2. **æ¸…ç†**: ä½¿ç”¨ defer ç¡®ä¿æµ‹è¯•èµ„æºè¢«æ¸…ç†
3. **è·³è¿‡**: æ— æ³•è¿æ¥æœåŠ¡å™¨æ—¶è·³è¿‡æµ‹è¯•è€Œä¸æ˜¯å¤±è´¥
4. **æ—¥å¿—**: ä½¿ç”¨ t.Log è¾“å‡ºè¯¦ç»†çš„æµ‹è¯•ä¿¡æ¯
5. **å¹¶å‘**: æµ‹è¯•å¹¶å‘åœºæ™¯ç¡®ä¿çº¿ç¨‹å®‰å…¨

## æ•…éšœæ’æŸ¥

### æµ‹è¯•å¤±è´¥
- ç¡®è®¤ beanstalkd æœåŠ¡æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ç«¯å£ 11300 æ˜¯å¦å¯è®¿é—®
- æŸ¥çœ‹æµ‹è¯•æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯

### æµ‹è¯•è·³è¿‡
å¦‚æœçœ‹åˆ° "SKIP" ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯å› ä¸ºæ— æ³•è¿æ¥åˆ° beanstalkd æœåŠ¡å™¨ã€‚

## æŒç»­é›†æˆ

è¿™äº›æµ‹è¯•å¯ä»¥é›†æˆåˆ° CI/CD æµç¨‹ä¸­ï¼š

```yaml
# .github/workflows/test.yml ç¤ºä¾‹
test:
  steps:
    - name: Start beanstalkd
      run: beanstalkd -l 127.0.0.1 -p 11300 &
    - name: Run tests
      run: cd tests && go test -v
```
